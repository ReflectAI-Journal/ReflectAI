# ReflectAI - Daily Reflection Companion

## Overview

ReflectAI is a full-stack journaling application that combines personal reflection with AI-powered insights. The application helps users maintain consistent journaling habits while providing thoughtful analysis and guidance through various AI personalities. It features journal entries, goal tracking, emotional analytics, and different AI conversation modes including philosophical discussions.

## System Architecture

### Frontend Architecture
- **Framework**: React 18 with TypeScript
- **Build Tool**: Vite for fast development and optimized production builds
- **Styling**: TailwindCSS with shadcn/ui component library for consistent design
- **State Management**: TanStack React Query for server state and local React state for UI
- **Routing**: Wouter for lightweight client-side routing
- **Animations**: Framer Motion for smooth UI transitions
- **Forms**: React Hook Form with Zod validation
- **Payment Processing**: Stripe integration for subscriptions

### Backend Architecture
- **Runtime**: Node.js with Express server
- **Language**: TypeScript for type safety
- **Authentication**: Passport.js with local strategy and session management
- **Database ORM**: Drizzle ORM with PostgreSQL
- **AI Integration**: OpenAI API (GPT-4o) for journal analysis and conversations
- **Email Service**: SendGrid for notifications
- **Session Storage**: In-memory store with configurable persistence

### Database Schema
- **Users**: Authentication, subscription status, trial management
- **Journal Entries**: Content, moods, AI responses, favorites
- **Journal Stats**: Streak tracking, mood analytics, entry counts
- **Goals**: Multi-level goal system (life, yearly, monthly, weekly, daily)
- **Goal Activities**: Time tracking, progress logging
- **Chat Usage**: AI conversation history and limits

## Key Components

### Journal System
- Rich text editor for daily entries
- Mood tracking and sentiment analysis
- AI-powered reflection generation with privacy safeguards
- Calendar-based navigation and archives
- Export functionality for data portability

### AI Personalities
- Multiple conversation modes: counselor, philosopher, general advice
- Customizable personality system with built-in and user-created options
- Context-aware responses based on journal content
- Content sanitization for privacy protection

### Goals and Progress Tracking
- Hierarchical goal structure supporting different time horizons
- Activity logging with time tracking
- Visual progress charts using Recharts
- Streak visualization and motivation systems

### Analytics and Insights
- Emotion timeline tracking
- Mind pattern analysis from journal content
- Memory Lane feature for revisiting past entries
- Statistical dashboards with various chart types

## Data Flow

1. **User Authentication**: Passport.js handles login/registration with bcrypt password hashing
2. **Journal Entry Creation**: React Hook Form → Validation → API → Drizzle ORM → PostgreSQL
3. **AI Analysis**: Journal content → Privacy sanitization → OpenAI API → Response storage
4. **Real-time Updates**: TanStack Query manages cache invalidation and optimistic updates
5. **Subscription Management**: Stripe webhooks → Database updates → Feature access control

## External Dependencies

### Core Services
- **Neon Database**: Serverless PostgreSQL hosting
- **OpenAI API**: GPT-4o for AI conversations and analysis
- **Stripe**: Payment processing and subscription management
- **SendGrid**: Email delivery service

### Development Tools
- **Replit**: Development environment with custom cartographer plugin
- **ESBuild**: Fast bundling for production server code
- **TypeScript**: Static type checking across the entire stack

### UI Libraries
- **Radix UI**: Headless components for accessibility
- **Lucide React**: Icon library
- **Recharts**: Data visualization components
- **Date-fns**: Date manipulation utilities

## Deployment Strategy

### Development
- Vite dev server for frontend with HMR
- tsx for running TypeScript server directly
- In-memory session storage for development simplicity
- Environment variables for API keys and database connections

### Production
- Static frontend build served by Express server
- ESBuild bundle for optimized server code
- SSL enforcement and security headers
- PostgreSQL with connection pooling
- Memory store with cleanup for session management

### Security Considerations
- Content Security Policy headers
- XSS protection and CSRF prevention
- Password hashing with bcrypt (industry standard)
- PII sanitization before AI processing
- Session timeout and secure cookie configuration

## Changelog
- July 23, 2025. Successfully migrated from Clerk to Firebase authentication and restored pricing pages:
  - Completely removed all Clerk dependencies (@clerk/clerk-react, @clerk/clerk-js, @clerk/clerk-sdk-node) from the codebase
  - Installed Firebase SDK and created Firebase configuration with project domain "reflect-ai-d56b2.firebaseapp.com"
  - Updated firebase.ts with complete Firebase configuration including actual Google API key (AIzaSyAfdr6NOIXScjwBbm6qGVG5PMGCz5RwGBo), auth domain, project ID, storage bucket, messaging sender ID, and app ID
  - Implemented Firebase authentication hooks with email/password, Google, and Apple sign-in support
  - Created comprehensive AuthProvider component with Firebase integration and demo mode fallback
  - Updated Auth.tsx with complete Firebase authentication UI including sign-in and sign-up forms
  - Replaced Clerk routing components with custom ProtectedRoute components using Firebase auth state
  - Added proper error handling and loading states for all authentication flows
  - Updated App.tsx to use Firebase AuthProvider instead of ClerkProvider
  - Restored pricing pages (/pricing and /subscription routes) with complete subscription functionality
  - Created NotFound.tsx page for 404 handling
  - Fixed all Firebase auth imports and cleaned up unused code throughout the application
  - Authentication system now supports: email/password login, user registration, Google OAuth, Apple OAuth, and sign-out functionality
  - Pricing system includes three tiers (Basic $14.99, Pro $24.99, Elite $50) with monthly/annual options and Stripe integration
- July 22, 2025. Successfully implemented clean email + password authentication system:
  - Completely removed username mapping complexity - now pure email + password authentication
  - Updated backend endpoints (/api/supabase/signup and /api/supabase/login) to use only email + password
  - Updated frontend Auth.tsx to show "Email" field instead of "Username" with proper validation
  - Updated all authentication interfaces and hooks to use email instead of username
  - Demo account working perfectly: email: demo@demo.com, password: demo123
  - Simplified user experience with standard email + password flow as requested
  - Authentication system now matches industry standards without complex username logic
- July 22, 2025. Successfully resolved Supabase authentication integration despite database dashboard issues:
  - Fixed email validation errors by using proper email formats (gmail.com, outlook.com work vs example.com rejected)
  - Confirmed Supabase auth.signUp() working correctly - users ARE being created in Supabase auth system
  - Updated server to gracefully handle profile creation failures while auth succeeds
  - Added admin client configuration with service role key support for future database operations
  - Identified Supabase dashboard database connection issue as infrastructure problem (not code issue)
  - Authentication flow now works end-to-end: signup creates Supabase auth users successfully
  - Users can access app immediately while profile table creation pending database accessibility
  - Created comprehensive setup documentation and status tracking for deployment completion
- July 22, 2025. Fixed JWT authentication system and protected API endpoint access:
  - Updated isAuthenticated middleware to support both JWT token and session authentication
  - Fixed getCurrentUser method in authService.ts to include JWT tokens in Authorization headers
  - Verified all protected endpoints (/api/stats, /api/subscription/status, /api/user) work with Bearer tokens
  - Authentication flow working end-to-end: login → JWT token → protected API access
  - Both frontend (Bearer tokens) and session-based authentication now work seamlessly
  - Users can now stay logged in and access counselor/dashboard routes without 401 errors
- July 22, 2025. Completed username-only authentication system implementation:
  - Updated login endpoint (/api/login) to accept username instead of email with Supabase fake email pattern
  - Modified frontend Auth.tsx component to use username field instead of email field
  - Updated useAuth hook and authService to handle username-based authentication
  - Removed email and phone number fields from CreateAccountModal, now requires only username + password
  - Users authenticate with username + password, system uses fake email pattern (username@reflect.fake) for Supabase compatibility
  - Completely eliminated email from user-facing authentication while maintaining backend compatibility
  - Fixed all TypeScript errors and form validation to work with new username-only flow
- July 22, 2025. Removed Google and Apple OAuth buttons from login page:
  - Deleted Google and Apple sign-in buttons from Auth.tsx login form
  - Removed OAuth-related imports (FcGoogle, SiApple icons)
  - Cleaned up divider section and OAuth button components
  - Login page now shows only email/password authentication form
  - OAuth functionality remains available on create account page for post-payment account creation
- July 22, 2025. Successfully configured Apple OAuth authentication with proper JWT tokens:
  - Created Apple private key file (AuthKey_T3FX2F7AM.p8) with official Apple credentials
  - Generated Apple JWT secret using proper Team ID (ZP23Y95ZSZ), Client ID (auth.reflectai), and Key ID (T3FX2F7AM)
  - Updated environment variables with correct Apple OAuth configuration
  - Installed jsonwebtoken library for JWT token generation
  - Both Google and Apple OAuth endpoints now redirect properly to their authentication services
  - Complete post-payment OAuth flow working: Stripe Payment → Create Account Page → Google/Apple OAuth → Account Creation → App Access
- July 22, 2025. Fixed critical server routing issue preventing API authentication:
  - Resolved duplicate login routes conflict between server/auth.ts (Passport.js) and server/routes.ts (Supabase)
  - Updated auth.ts login route to use Supabase authentication with email/password instead of username/password
  - Removed duplicate login route from routes.ts to eliminate route conflicts
  - Fixed "Missing credentials" error by ensuring proper API route handling before Vite middleware
  - Login form now successfully sends email/password to backend and receives proper JSON responses
  - Verified JSON middleware is working correctly and API endpoints are accessible
- July 22, 2025. Fixed critical password authentication vulnerability:
  - Replaced unsafe `timingSafeEqual()` buffer comparison with secure `bcrypt.compare()` method
  - Updated `hashPassword()` function to use `bcrypt.hash()` instead of custom scrypt implementation
  - Eliminated "Input buffers must have the same byte length" error in `/api/login` route
  - Enhanced security by using industry-standard bcrypt library for password hashing and verification
  - All new user registrations now use bcrypt hashing automatically
- July 22, 2025. Added Google and Apple OAuth to post-payment account creation:
  - Implemented "Continue with Google" and "Continue with Apple" buttons on create account page
  - Modified OAuth routes to handle Stripe session ID and plan parameters for subscription verification
  - Updated OAuth callbacks to create accounts with automatic subscription attachment
  - Enhanced user experience by allowing existing Google/Apple users to skip manual form filling
  - OAuth integration works seamlessly with payment-first flow: Stripe payment → OAuth login → account creation with subscription
- July 22, 2025. Updated Basic plan to 10 AI counseling sessions per month and improved UI layout:
  - Changed Basic plan from unlimited to 10 AI counselor sessions per month (one session = full conversation until user leaves and returns)
  - Updated backend storage logic to track and limit Basic users to 10 monthly sessions
  - Modified SessionUsageDisplay component to show proper session counts for Basic users
  - Updated subscription page to reflect "10 AI counselor sessions per month" feature
  - Made counselor match banner smaller and centered (max-width with card layout instead of full-width)
  - Business model now: Basic (10 sessions/month), Pro (25 sessions/month + voice), Elite (unlimited + voice)
- July 22, 2025. Added voice conversation features for premium subscribers:
  - Added voice conversation capabilities for Pro and Elite plan subscribers
  - Created VoiceControls component with speech recognition and text-to-speech functionality
  - Added `/api/speech/transcribe` endpoint using OpenAI Whisper API for voice-to-text conversion
  - Implemented automatic text-to-speech for AI responses when voice mode is enabled
  - Voice features restricted to Pro and Elite plans via subscription tier checking
  - Updated pricing pages to highlight voice conversation as premium feature
  - Removed "Personalized AI counselor trained on your journal" feature from Elite plans per user request
  - Voice controls integrated into ChatContainer with toggle for voice responses and recording capabilities
- July 22, 2025. Implemented AI counseling session limits based on subscription tiers:
  - Basic plan users: Text conversation with AI counselor (unlimited sessions)
  - Pro plan users: 25 AI counseling sessions per month plus voice conversation features
  - Elite plan users: unlimited AI counseling sessions plus voice conversation features
  - Updated database schema to track monthly chat usage instead of weekly usage
  - Added `/api/chatbot/message` endpoint with authentication and session limit enforcement
  - Created `/api/chatbot/usage` endpoint to display remaining sessions to users
  - Modified storage methods to properly track and enforce monthly session limits
  - Added SessionUsageDisplay component showing remaining sessions with progress bar
  - Users receive clear error messages when exceeding monthly limits with upgrade prompts
  - VIP users maintain unlimited access regardless of subscription plan
  - Session usage resets on the first day of each month automatically
- July 22, 2025. Updated pricing plan features across all subscription tiers:
  - Removed "Access to a public community group or forum" feature from Pro plans (monthly and annual)
  - Added "Weekly mood analysis & mental health reports" feature to ALL plans (Basic, Pro, and Elite)
  - Updated both Pricing.tsx and Subscription.tsx pages to reflect new feature set
  - All users now get comprehensive mood tracking and mental health insights regardless of plan tier
- July 22, 2025. Added human faces and characters throughout interface for better relatability:
  - Updated counselor questionnaire completion screen to use professional woman character (👩‍💼)
  - Added human characters to landing page chat demo interface (👩‍⚕️ for AI, 😊 for users)
  - Enhanced AI counselor representations in main chat interface and feature showcases
  - Replaced generic AI avatars with relatable human healthcare professional emojis
  - Improved mobile navigation with hamburger menu showing Features, About, and Pricing links
  - Mobile menu has smooth animations and properly closes when navigation items are selected
- July 21, 2025. Implemented session caching to prevent Stripe re-verification errors during account creation:
  - Added in-memory session cache to validate Stripe sessions only once per account creation flow
  - Created validatedSessions Map with automatic cleanup after 1 hour to prevent memory leaks
  - Updated account creation logic: first call validates with Stripe and caches, subsequent calls use cache
  - Added /api/supabase/validate-session endpoint for pre-validation of payment sessions
  - Fixed "payment session has already been used" errors by eliminating duplicate Stripe API calls
  - Cache is cleared after successful account creation to prevent session reuse across different accounts
  - Enhanced error handling to gracefully fall back to Stripe validation if cache is empty
- July 21, 2025. Implemented conditional session reuse handling for account creation:
  - Added stripe_session_id tracking to Supabase user interface for session reuse prevention
  - Created getUserByStripeSessionId method to check if session has been used before
  - Updated account creation endpoint to detect used sessions and redirect to /app/counselor instead of showing error
  - Added graceful handling for tables without stripe_session_id column (backwards compatibility)
  - Enhanced CreateAccountModal to show "Welcome Back!" for returning users vs "Account Created!" for new users
  - Session IDs now stored for analytics, audit, and support purposes while preventing duplicate account creation
  - Flow: unused session → create account, used session → redirect to counselor page seamlessly
- July 21, 2025. Integrated Supabase database option alongside existing PostgreSQL setup:
  - Added @supabase/supabase-js package for database operations
  - Created comprehensive Supabase client and storage class in server/supabase.ts
  - Added Supabase environment variables (SUPABASE_URL, SUPABASE_ANON_KEY) to .env
  - Created complete database schema (supabase-schema.sql) with tables for users, journal_entries, journal_stats, goals, and chat_usage
  - Implemented Row Level Security (RLS) policies for data protection and server-side access
  - Added new Supabase API endpoints: /api/supabase/create-account-with-subscription, /api/supabase/user/:id, /api/supabase/update-subscription
  - Modified CreateAccountModal to support both PostgreSQL and Supabase backends via VITE_USE_SUPABASE environment flag
  - Created comprehensive SUPABASE_SETUP_GUIDE.md with step-by-step setup instructions
  - Hybrid approach allows testing Supabase while maintaining existing PostgreSQL functionality
  - Full user management including Stripe integration, subscription tracking, and data storage now available in Supabase
## Changelog
- July 21, 2025. Implemented payment-first user flow with Stripe session verification:
  - Updated Pricing page to redirect directly to Stripe checkout with payment-first flag
  - Created CreateAccount page for post-payment account creation with session verification
  - Added /api/create-account-with-subscription endpoint to verify Stripe sessions and create users
  - Updated checkout session creation to support two flows: payment-first vs standard
  - Added stripeSessionId field to users schema to prevent session reuse
  - New flow: Pricing → Stripe Payment → /create-account?session_id=xxx → Account Creation → App Access
  - Users now pay first, then create accounts with subscriptions automatically attached
- July 21, 2025. Fixed registration routing errors and simplified user flow logic:
  - Removed complex FlowNavigator middleware that was causing "Cannot read properties of undefined" errors
  - Simplified registration flow: new users go directly to /subscription after account creation
  - Simplified login flow: existing users go directly to /app/counselor (middleware handles subscription checks)
  - Fixed routing middleware to properly handle authentication and subscription status
  - Updated Pricing page to store plan selection in sessionStorage and redirect to registration
  - All authentication flows now work without complex API dependency chains
- July 21, 2025. Streamlined questionnaire completion flow to redirect directly to counselor chat:
  - Updated questionnaire completion to redirect users directly to `/app/counselor` instead of match page
  - Modified CounselorMatch page redirect to go to counselor chat instead of subscription page
  - Added `/app/questionnaire` route for logged-in users who want to retake the questionnaire
  - Created reset endpoint `/api/user/reset-questionnaire` for users to retake questionnaire
  - Complete questionnaire flow: questions → automatic counselor match → direct access to AI chat
- July 21, 2025. Removed "Dr." titles from counselor personalities per user request:
  - Updated all counselor names from "Dr. Maya", "Dr. Alex", etc. to simple "Maya", "Alex", "River", "Samuel", "Jordan"
  - Simplified personality display names in both questionnaire results and personality selector
  - Maintained professional counselor descriptions without formal titles for more approachable user experience
  - Fixed React warnings caused by duplicate personality keys in PersonalitySelector component
- July 21, 2025. Updated all authentication flows to redirect to counselor page:
  - Changed Google OAuth callback redirect from '/pricing' to '/app/counselor' for immediate AI access
  - Changed Apple OAuth callback redirect from '/pricing' to '/app/counselor' for consistency
  - Updated standard login redirect logic to go directly to '/app/counselor' for all users
  - Updated registration redirect logic to go directly to '/app/counselor' for all new users
  - Simplified authentication useEffect to redirect all authenticated users to counselor page
  - Users now go directly to the AI counselor interface after any successful authentication
  - Enhanced user experience by removing all intermediate pricing/subscription page steps
- July 20, 2025. Implemented Google OAuth authentication with pricing page redirect:
  - Added Google OAuth using googleapis library directly instead of passport-google-oauth20 for proper authorization code exchange
  - Updated user schema to include googleId field for tracking Google-authenticated users
  - Created automatic user account creation for new Google users with secure random passwords
  - Added "Continue with Google" buttons to both login and register forms with proper styling
  - Configured OAuth callback to redirect users directly to counselor page for immediate access
  - Enhanced authentication flow: Google sign-in → counselor page for immediate AI interaction
  - Updated both login and registration flows to handle pricing page selections with automatic Stripe checkout
- July 20, 2025. Added Apple OAuth authentication integration:
  - Installed apple-auth and jsonwebtoken packages for Apple Sign-In functionality
  - Created Apple OAuth configuration with client ID, team ID, key ID, and private key from environment variables
  - Added Apple OAuth routes: /auth/apple (initiate) and /auth/apple/callback (handle response)
  - Updated user schema to include appleId field for tracking Apple-authenticated users
  - Added "Continue with Apple" buttons to both login and register forms alongside Google
  - Configured Apple OAuth to follow same pricing page redirect flow as Google authentication
  - Apple Sign-In now supports: Apple ID → pricing plans → login → Stripe checkout
- July 20, 2025. Fixed login redirect bouncing behavior for direct counselor access:
  - Simplified login flow to go directly to counselor page for standard login
  - Removed aggressive auto-redirects from auth page that caused page bouncing
  - Maintained pricing plan workflow for users coming from pricing selection
  - Login now goes straight to /app/counselor without intermediate redirects or error pages
- July 20, 2025. Enhanced Pro plan blueprint feature with comprehensive personalization system:
  - Expanded blueprint questionnaire from 5 to 12+ detailed questions covering anxiety frequency, overthinking patterns, physical symptoms, trigger situations, current strategies, effectiveness assessment, preferred approaches, time availability, social support, past experiences, specific goals, and learning style preferences
  - Completely rewrote PDF generation service to create truly personalized content based on individual user responses rather than generic templates
  - Implemented dynamic content generation that customizes emergency techniques, daily prevention plans, and specific strategies based on user's time availability, preferred approaches, and trigger situations
  - Added personalized sections for overthinking pattern management, physical symptom relief, situation-specific strategies, and support resource recommendations
  - Enhanced PDF layout with step-by-step personalized action plans, highlighted emergency sections, and user-specific goal setting
  - Blueprint PDFs now contain 4-6 pages of tailored mental health guidance specifically designed for each individual user's needs and circumstances
- July 20, 2025. Fixed mobile zoom issue on text input focus:
  - Updated viewport meta tags to include `user-scalable=no` and `maximum-scale=1.0` to prevent unwanted zooming
  - Added CSS rules ensuring all input fields use 16px font size to prevent iOS Safari auto-zoom behavior
  - Applied webkit-specific styles to prevent input appearance issues on mobile devices
  - Enhanced mobile user experience by eliminating disruptive zoom behavior when tapping on text fields, password fields, and textareas
- July 20, 2025. Enhanced landing page navigation and improved header layout:
  - Added prominent Pricing button in header navigation next to Login button for improved visibility
  - Removed duplicate Pricing link from desktop navigation menu to avoid redundancy
  - Pricing button now visible on all screen sizes with consistent styling and positioning
  - Enhanced user journey with clear access to pricing information from any page
- July 20, 2025. Implemented VIP user system for free family/friend access:
  - Added isVipUser boolean field to users table for bypassing all subscription checks
  - Updated subscription middleware to grant unlimited access to VIP users
  - VIP users automatically get "unlimited" plan privileges without payment
  - Added admin API routes for managing VIP status (/api/admin/vip/:userId and /api/admin/users)
  - Created comprehensive VIP_ACCESS_GUIDE.md with multiple methods for granting free access
  - VIP users have access to all Pro/Elite features including Blueprint PDFs and unlimited AI conversations
- July 20, 2025. Updated login flow to redirect users directly to AI counselor page:
  - Changed authentication redirect from '/app' to '/app/counselor' for immediate counselor access
  - Users now land on the AI counselor interface immediately after login
  - Streamlined user experience by removing intermediate home page step
- July 20, 2025. Added Counselor tab to bottom navigation and removed landing page redirects:
  - Added Counselor tab in the middle of bottom navigation between Philosopher and Patterns
  - Used Brain icon for Counselor tab for better visual identification 
  - Updated all back buttons to redirect to /app/counselor instead of landing page
  - Removed all navigation paths that redirect users back to landing page from within the app
- July 20, 2025. Implemented account-first workflow for all pricing buttons:
  - Updated button text to "Try Basic", "Try Pro", and "Try Elite" across Landing, Pricing, and Subscription pages
  - Updated all pricing plan buttons to redirect to account creation (/auth?tab=register&source=pricing) instead of direct Stripe checkout
  - Modified registration flow in Auth.tsx to check for selected plan in sessionStorage and redirect to Stripe checkout after account creation
  - Added plan selection persistence using sessionStorage to maintain user's pricing choice through registration
  - Updated Pricing.tsx handleSelectPlan function to store plan data and redirect to account creation
  - Updated Subscription.tsx handlePlanSelect function to follow same account-first flow
  - Updated Landing page Pro and Elite plan buttons to store plan info and redirect to registration
  - New user journey: Select Plan → Create Account → Automatic Stripe Checkout → App Access
- July 20, 2025. Enhanced landing page navigation and AI branding:
  - Added Login button back to header navigation for improved user access
  - Replaced generic checkmark and star icons with Brain symbols for AI counselor interface
  - Removed redundant Login buttons below chat interface to reduce visual clutter
  - Updated AI counselor representation with Brain icons to better convey intelligence and AI functionality
  - Added Pricing button at bottom of features section to guide users to subscription plans
- July 20, 2025. Removed Login button from landing page header:
  - Deleted Login button from landing page header navigation
  - Simplified header design with only Features, About, and Pricing links
  - Streamlined user experience focusing on content over immediate login prompts
- July 20, 2025. Fixed Stripe price ID configuration for all subscription plans:
  - Updated all three checkout endpoints (/api/stripe/subscribe, /api/create-checkout-session, /api/checkout-session)
  - Corrected Basic plan mapping: monthly $14.99 (price_1RlExqDBTFagn9VwAaEgnIKt), annual $152.90 (price_1Rl3P8DBTFagn9Vw8tyqKkaq)
  - Corrected Pro plan mapping: monthly $24.99 (price_1Rl3OWDBTFagn9Vw1ElGMTMJ), annual $254.90 (price_1Rl3Q3DBTFagn9VwMv0zw3G9)  
  - Updated .env file with correct Stripe price IDs for all plans
  - Fixed plan pricing structure and eliminated "unlimited" references in favor of Basic/Pro/Elite tiers
- July 20, 2025. Fixed contact button accessibility for unauthenticated users:
  - Added public /feedback route for landing page users who aren't logged in
  - Updated Landing.tsx contact button to navigate to /feedback instead of /app/feedback
  - Both authenticated and unauthenticated users can now access feedback functionality
  - Maintains consistent user experience across all contact touchpoints
- July 20, 2025. Fixed Elite plan checkout to ensure all paths go to Stripe checkout:
  - Updated Pricing.tsx to use direct Stripe checkout instead of multi-step form
  - All Elite plan buttons now call /api/checkout-session for immediate Stripe redirect
  - Verified server endpoint supports elite-monthly and elite-annually price IDs
  - Consistent checkout experience across Landing, Pricing, and Subscription pages
- July 20, 2025. Updated menu feedback button to match bottom navigation functionality:
  - Changed ProfileMenu feedback to navigate to /app/feedback instead of opening modal
  - Removed FeedbackModal import and state management from ProfileMenu component  
  - Both footer Contact and app feedback menu now consistently navigate to same feedback page
  - Cleaned up unused modal code for cleaner component architecture
- July 20, 2025. Updated footer navigation to streamline user experience:
  - Removed "Pricing" link from footer navigation
  - Changed "Contact" link to navigate to /app/feedback instead of opening email client
  - Footer now shows only Features, About, and Contact with consistent styling
- July 20, 2025. Changed all landing page buttons from "Find Your Counselor" to "Login":
  - Updated header, hero section, and features section buttons to say "Login"
  - All buttons now navigate to /auth?tab=login for streamlined login experience
  - Maintained consistent gradient styling and button animations throughout
- July 20, 2025. Added comprehensive three-plan pricing section to bottom of landing page:
  - Created animated pricing cards with Basic ($14.99), Pro ($24.99, Most Popular), and Elite ($50) plans
  - Enhanced all checkout endpoints (/api/stripe/subscribe, /api/create-checkout-session, /api/create-subscription-checkout) to support all three plans
  - Updated webhook handlers to properly recognize Basic, Pro, and Elite subscriptions 
  - Added hover effects, gradient themes, and proper feature lists for each plan
  - Fixed pricing amounts in backend to match frontend display ($14.99, $24.99, $50 monthly)
  - Updated pricing card colors to match page's blue-to-violet theme instead of bright colors
  - Fixed "Most Popular" badge positioning with proper spacing and visibility
  - Removed duplicate "Inside the Experience" section to eliminate redundant interface previews
  - All plans now redirect to /subscription page for complete checkout experience
- July 20, 2025. Updated domain configuration to use custom domain reflectai-journal.site:
  - Updated all Stripe checkout session URLs to use custom domain https://reflectai-journal.site
  - Fixed success and cancel URLs for all three checkout endpoints (/api/stripe/subscribe, /api/create-checkout-session, /api/checkout-session)
  - Removed trial_period_days from all Stripe subscription sessions to enforce immediate payment
  - Customers now pay upfront with 30-day email-based money-back guarantee policy
  - Custom domain now routes directly to landing page and handles all payment confirmations
- January 22, 2025. Implemented 7-day free trial on all subscription plans:
  - Added trial_period_days: 7 to all Stripe checkout sessions across all payment endpoints
  - Updated subscription page to show "7-day free trial - cancel anytime" messaging
  - Changed button text to "Start 7-Day Free Trial" on all pricing and subscription pages
  - Updated Pricing page to display "Start your 7-day free trial - no payment required upfront"
  - Modified Terms of Service to replace refund policy with comprehensive free trial policy
  - Updated billing policy to clarify no upfront payment required during trial period
  - All users can now experience full features for 7 days before being charged
- July 20, 2025. Updated landing page title to "From Racing Thoughts to Calm Decisions — In One Minute" with proper capitalization
- July 19, 2025. Created comprehensive pricing page with three subscription tiers:
  - Added new /pricing route with Basic ($15/month), Pro ($25/month), and Elite ($75/month) plans
  - Implemented detailed feature comparison with check-mark lists for each plan
  - Added animated pricing cards with hover effects and popular plan highlighting
  - Pro plan highlighted as "Most Popular" with enhanced styling and scale effects
  - Elite plan positioned as premium option with crown icon and comprehensive feature set
  - Integrated with existing checkout flow via plan parameter passing
  - Updated landing page navigation to include direct pricing page link
  - Enhanced user journey from landing page to pricing selection to checkout
- July 18, 2025. Updated domain configuration for multi-domain support:
  - Added current Replit development domain to CORS configuration
  - Updated server to accept requests from all three domains: reflectai-n3f0.onrender.com, reflectai-journal.site, and current Replit dev domain
  - Configured REPLIT_DOMAINS environment variable with all production domains
  - Ensured all domains properly serve the landing page and full application
  - Both production domains and development domain now have identical routing behavior
- July 18, 2025. Streamlined checkout flow and fixed layout issues:
  - Updated checkout flow to skip review page and go directly from personal info to Stripe checkout
  - Added Terms of Service and Privacy Policy checkboxes to personal info form (CheckoutStep1)
  - Added optional newsletter subscription checkbox with proper validation
  - Fixed chat interface overlapping layout issues with proper flexbox and viewport calculations
  - Added credentials: 'include' to frontend fetch requests for proper cookie handling
  - Fixed REPLIT_DOMAINS environment variable and checkout URL configuration
  - Verified Stripe checkout session creation is working correctly (creates customers and sessions)
  - Updated checkout button text to "Continue to Stripe Checkout" to reflect direct flow
- July 17, 2025. Fixed deployment build errors and updated checkout flow:
  - Resolved Vite CommonJS/ESM module conflicts by removing transpiled .js files
  - Fixed build process to successfully generate production artifacts
  - Updated subscription buttons to redirect directly to Stripe checkout instead of multi-step flow
  - Created simplified /api/checkout-session endpoint for immediate Stripe redirects
  - Configured live Stripe integration with proper webhook URL: https://reflectai-n3f0.onrender.com/api/stripe/webhook
  - All Stripe keys and price IDs confirmed in live mode for production deployment
- July 17, 2025. Added simplified checkout session endpoint for frontend compatibility:
  - Created new `/api/checkout-session` endpoint that matches frontend API calls
  - Simplified interface: takes planId, returns { url } for direct Stripe redirect
  - Frontend can now use: `const res = await fetch("/api/checkout-session", { method: "POST" }); window.location.href = data.url;`
  - Endpoint follows the pattern: success_url, cancel_url, customer_email, mode: "subscription", with 3-day trial
  - Both `/api/checkout-session` and `/api/create-checkout-session` endpoints now available
- July 17, 2025. Updated counselor match button to redirect to subscription plans:
  - "Start Counseling with Maria" button now navigates to `/subscription` instead of `/app/counselor`
  - Users must select and pay for a subscription plan before accessing AI counselor features
  - Maintains counselor profile in sessionStorage for personalization after subscription
- July 16, 2025. MAJOR ARCHITECTURAL CHANGE: Completely removed embedded Stripe Elements in favor of hosted checkout only:
  - Removed all Stripe Elements dependencies and providers from App.tsx routing
  - Updated Subscription.tsx to use only hosted checkout redirects via /api/create-checkout-session
  - Simplified CheckoutStep2.tsx and EmbeddedCheckout.tsx to redirect to subscription page
  - Removed embedded payment forms, StripeCheckout, and EmbeddedCheckoutForm components
  - Updated server routes to use proper HTTPS URLs for Stripe success/cancel redirects
  - Fixed "Invalid URL" error by adding https:// scheme to REPLIT_DOMAINS URLs
  - Fixed blank Stripe checkout by opening in new tab instead of current window
  - Configured all live Stripe price IDs for Pro and Unlimited plans (monthly/annual)
  - Updated free trial period from 7 days to 3 days across all subscription plans
  - Updated Stripe checkout success/cancel URLs to use custom domain: https://reflectai-journal.site
  - Application now uses exclusively Stripe Hosted Checkout (redirect) for all payment processing
  - Users click "Start 3-Day Free Trial" and are redirected to secure Stripe checkout pages
  - Eliminates all client-side Stripe Elements integration for simplified, secure payment flow
- July 16, 2025. Fixed Stripe webhook middleware order for proper signature verification:
  - Moved Stripe webhook setup to occur BEFORE express.json() middleware in server/index.ts
  - Created setupStripeWebhook() function that uses express.raw({type: 'application/json'})
  - Webhook now properly receives raw body for signature verification instead of parsed JSON
  - Removed duplicate webhook handlers to avoid conflicts
  - Fixed middleware order: CORS → Security → Webhook (raw) → JSON parsing → Other routes
  - Webhook endpoint /api/stripe/webhook now correctly validates Stripe signatures
- July 16, 2025. Implemented JWT Bearer token authentication alongside session-based auth:
  - Added JWT token generation and verification using jsonwebtoken library
  - Backend /api/user endpoint now supports both Bearer token and session authentication
  - Frontend stores JWT tokens in localStorage and includes them in Authorization headers
  - All API requests via apiRequest() function now automatically include Bearer tokens
  - Login and registration endpoints return JWT tokens along with user data
  - Hybrid authentication system: JWT tokens for API calls, sessions for backward compatibility
  - Complete authentication debugging with comprehensive logging for troubleshooting
  - Authentication flow: login → receive JWT token → store in localStorage → include in API headers
- July 16, 2025. Finalized clean Stripe Elements integration:
  - Implemented proper Stripe initialization: `const stripePromise = loadStripe(import.meta.env.VITE_STRIPE_PUBLISHABLE_KEY)`
  - All payment components properly wrapped in `<Elements stripe={stripePromise}>` from App.tsx routing
  - Removed duplicate Elements providers from StripeCheckout and EmbeddedCheckout components
  - Fixed conflicting Stripe instances by using single Elements provider from App.tsx routing
  - Added comprehensive defensive checks to CheckoutStep2, StripeCheckout, and EmbeddedCheckoutForm components
  - All Stripe-related components now gracefully handle loading states while Elements initialize
  - Clean architecture with no Elements context errors or provider conflicts
- July 16, 2025. Fixed Stripe price ID configuration errors:
  - Updated all placeholder price IDs in .env to use working price ID for development
  - Fixed "No such price" error by replacing invalid placeholder IDs with actual Stripe price ID
  - All subscription plans now use the same working price ID for testing purposes
  - Payment processing now works correctly for all plan types (pro/unlimited, monthly/annually)
  - Production deployment will require creating separate price IDs for each plan in Stripe dashboard
- July 16, 2025. Fixed post-payment authentication and routing issues:
  - Fixed 404 error after successful payment by adding proper query cache invalidation
  - Added React Query cache invalidation for user authentication state after checkout login
  - Fixed routing issue where users couldn't access /app after successful payment
  - Enhanced checkout flow with proper authentication state refresh
  - Users now properly access the app after successful subscription creation
- July 16, 2025. Fixed Stripe API subscription creation format:
  - Updated subscription creation to use proper Stripe API format with `price` instead of `price_data`
  - Fixed "unknown parameter" error by using environment variable price IDs
  - Subscription creation now uses the correct format: `items: [{ price: priceId }]`
  - Added proper price ID mapping for all subscription plans (pro/unlimited, monthly/annually)
  - Stripe subscriptions will now appear correctly in the dashboard with proper pricing
- July 16, 2025. Fixed checkout authentication and enhanced Stripe integration:
  - Created new `/api/create-subscription-checkout` endpoint for unauthenticated users
  - Added automatic account creation during checkout process with proper user data
  - Implemented `/api/checkout-login` endpoint for automatic login after successful payment
  - Enhanced Stripe webhook handling for better subscription tracking in dashboard
  - Fixed checkout flow to work from any URL without authentication errors
  - Added comprehensive error handling and user feedback throughout payment process
  - Checkout now redirects to app after successful payment with user logged in
- July 16, 2025. Fixed Stripe input text visibility in light mode:
  - Updated CSS to use theme-aware colors for Stripe Elements text instead of hard-coded white
  - Added dynamic color functions to CheckoutStep2 and StripeCheckout components
  - Stripe inputs now display black text in light mode and white text in dark mode
  - Fixed security code field visibility issues for better user experience
- July 16, 2025. Updated free trial buttons to bypass login and go directly to checkout:
  - Changed "Free Trial" buttons to navigate to `/checkout-step1` instead of `/checkout/plan-id`
  - Added plan parameters to checkout URLs (pro-monthly and unlimited-monthly)
  - Users can now start the checkout process without authentication requirements
  - Streamlined user experience by removing authentication barrier for trial signup
- July 16, 2025. Updated subscription buttons to emphasize free trial offering:
  - Changed "Get Pro Monthly" button text to "Free Trial" in pricing section
  - Changed "Get Unlimited Monthly" button text to "Free Trial" in pricing section
  - Maintained existing pricing information and secondary annual buttons
  - Enhanced focus on free trial value proposition for user acquisition
- July 16, 2025. Cleaned up duplicate ReflectAI logos to keep only one in header:
  - Removed duplicate ReflectAI logo from Footer component
  - Kept only the main ReflectAI logo in Header component for consistent branding
  - Cleaned up unused logo import from Footer component
  - Maintained copyright text in footer while removing visual logo duplication
- July 16, 2025. Removed Light Mode button from profile menu while maintaining theme functionality in Settings:
  - Removed the "Light Mode" toggle button from the profile dropdown menu
  - Cleaned up unused theme state and toggle function from ProfileMenu component
  - Removed unused Moon and Sun icon imports from ProfileMenu
  - Maintained full theme switching functionality in Settings page with Light/Dark/System options
  - Light mode theme system now working correctly with proper CSS variables and class application
  - Theme preferences are still properly saved in localStorage and applied across the application
- July 16, 2025. Enhanced Stripe customer creation and payment method attachment:
  - Updated customer creation to attach payment method during creation with payment_method and invoice_settings
  - Modified both /api/create-subscription and /api/create-subscription-simple endpoints for better payment method handling
  - For new customers: payment method attached during customer creation with default payment method settings
  - For existing customers: payment method attached separately and set as default via customer update
  - Added stripe.confirmCardSetup implementation to CheckoutStep2.tsx and StripeCheckout.tsx
  - Frontend can now handle setup intent client secrets using confirmCardSetup method
  - Backend updated to provide setupIntentClientSecret in subscription creation responses
  - Added environment variable-based subscription creation endpoint /api/create-subscription-simple
  - Configured multiple Stripe price IDs in environment variables for different subscription plans
  - Both payment confirmation methods (confirmCardPayment and confirmCardSetup) now available
- July 16, 2025. Fixed Stripe setup intent configuration for embedded checkout:
  - Fixed setup intent error by adding automatic_payment_methods configuration with allow_redirects: 'never'
  - Restricted payment method types to 'card' only for embedded checkout compatibility
  - Enhanced setup intent to work properly with in-app payment processing without requiring return_url
  - Payment method validation now works seamlessly within the embedded checkout flow
- July 16, 2025. Redesigned checkout page with clean, professional layout:
  - Implemented modern, minimalist design with improved spacing and typography
  - Simplified form inputs with consistent styling and better visual hierarchy
  - Enhanced grid layout with payment form and billing information sidebar
  - Removed excessive gradients and decorative elements for cleaner appearance
  - Streamlined security indicators and trust badges throughout the page
- July 16, 2025. Fixed Stripe API integration and enhanced checkout page design:
  - Fixed Stripe API structure from invalid `product: name` to correct `product_data: { name, description }` format
  - Resolved "No such product" error by using proper Stripe API v2024-06-20 structure for dynamic product creation
  - Enhanced CheckoutStep2 page with professional design including SSL/PCI compliance badges
  - Added trust indicators, security messaging, and improved visual hierarchy throughout payment form
  - Enhanced card input fields with better styling, icons, shadows, and hover effects
  - Improved submit button with gradient effects, loading states, and security messaging
  - Added comprehensive security footer with compliance badges and Stripe branding
  - Payment processing now works correctly within the app using embedded Stripe Elements
- July 16, 2025. Restored embedded Stripe Elements for in-app payment processing:
  - Reverted to embedded Stripe Elements approach to keep payment processing within the app
  - Updated /api/create-subscription endpoint to handle payment methods and create subscriptions directly
  - Modified CheckoutStep2 to process payments inline using Stripe Elements instead of external redirects
  - Maintained proper product_data structure with latest Stripe API version 2024-06-20
  - Users complete payment without leaving the app while maintaining 7-day trial period
  - Embedded payment flow provides seamless user experience while staying within the application
- July 16, 2025. Implemented proper credit card processing with Stripe Elements:
  - Updated StripeCheckout component to collect and process credit card data directly through Stripe Elements
  - Modified /api/create-subscription endpoint to handle payment methods and create subscriptions properly
  - Credit card information now flows securely to Stripe for payment processing with 7-day trial period
  - Replaced redirect-based checkout with embedded payment method collection and subscription creation
  - Enhanced checkout.session.completed webhook with comprehensive logging and metadata handling
  - Replaced SendGrid with Resend email service for reliable feedback delivery
  - Verified feedback system works with screenshot capture and email delivery
- July 16, 2025. Implemented unified 3-step checkout flow with consistent design template:
  - Created complete checkout sequence: Subscription (plan selection) → CheckoutStep1 (personal info) → CheckoutStep2 (payment)
  - Applied consistent design template with same colors, borders, and spacing across all three pages
  - Added unified progress indicators showing current step (1: Choose Plan, 2: Personal Info, 3: Payment)
  - Removed country field from checkout form per user request, simplified billing address collection
  - Updated all pages to use same background gradient, card styling, and button designs
  - Enhanced backend API to handle personal information and create proper Stripe subscriptions with US default country
  - Built CheckoutStep1 with Google autofill option and CheckoutStep2 with enhanced Stripe Elements integration
  - Integrated sessionStorage to persist user data between checkout steps with comprehensive form validation
- July 16, 2025. Redesigned checkout page with modern, spacious design matching subscription page style:
  - Enhanced header with large gradient title and prominent trust indicators in rounded containers
  - Redesigned form sections with larger cards, backdrop blur effects, and enhanced shadows
  - Improved input field styling with larger padding, rounded corners, and focus ring effects
  - Enhanced button with gradient background, hover animations, and scale transform effects
  - Upgraded order summary with gradient plan header, larger text, and improved visual hierarchy
  - Added consistent spacing, modern borders, and professional color scheme throughout
  - Complete visual redesign transforms checkout into premium, professional experience
- July 16, 2025. Enhanced Stripe webhook handling and completed minimalistic checkout design:
  - Added comprehensive webhook handlers for payment_intent.created and payment_intent.succeeded events
  - Removed neon gradient backgrounds in favor of clean, professional gray and white containers
  - Expanded order summary with larger fonts and spacing for better visual hierarchy
  - Streamlined card input styling with subtle blue focus states instead of bright colors
  - Maintained friendly user experience with icons while achieving elegant minimalistic design
  - All Stripe events now properly tracked and handled for both embedded and hosted checkout flows
- July 15, 2025. Enhanced embedded Stripe checkout with professional design and proper dark theme integration:
  - Updated color scheme to match website's design system using CSS custom properties
  - Applied dark theme to Stripe Elements with proper night theme configuration
  - Fixed white border issues and expanded checkout to full width
  - Added comprehensive Stripe appearance customization with dark backgrounds
  - Enhanced trust indicators with SSL encryption and PCI compliance badges
  - Integrated "Powered by stripe" branding for credibility
  - Professional gradient headers and consistent styling throughout form
  - Seamless payment experience that maintains website's visual identity
- July 15, 2025. Restored embedded Stripe checkout within the app:
  - Recreated EmbeddedCheckoutForm component with comprehensive payment collection
  - Added EmbeddedCheckout page for in-app payment processing
  - Implemented full billing address collection, age verification, and terms agreement
  - Added /embedded-checkout route with Stripe Elements integration
  - Updated subscription page to use embedded checkout by default
  - Removed secondary "Continue with Stripe Checkout" button for cleaner interface
  - Users can now complete payments without leaving the website
  - Enhanced payment security with Stripe's embedded Elements system
- July 15, 2025. Simplified payment flow to use only Stripe hosted checkout:
  - Removed embedded checkout forms and components completely
  - Updated subscription page to use only Stripe's hosted checkout for all plans
  - Deleted EmbeddedCheckout, TestEmbedded pages and EmbeddedCheckoutForm component
  - Removed /api/create-subscription endpoint since only hosted checkout is used
  - Simplified user experience with direct redirect to professional Stripe checkout pages
  - All payment processing now handled securely through Stripe's PCI-compliant hosted forms
- July 15, 2025. Fixed critical Stripe API errors and enhanced embedded checkout styling:
  - Resolved "unknown parameter" error by using proper Stripe API structure (product → price → subscription)
  - Fixed null client_secret error during trial periods by handling trial vs immediate payment scenarios
  - Updated payment field styling with black text color for consistency with form design
  - Enhanced payment section with proper form integration and professional appearance
  - Added trial period handling that doesn't require payment during the 7-day free trial
  - Subscription creation now properly supports both trial activation and immediate billing
- July 15, 2025. Successfully completed embedded Stripe checkout form implementation:
  - Built comprehensive EmbeddedCheckoutForm component using Stripe Elements
  - Added full data collection: personal info, billing address, date of birth validation (13+ requirement)
  - Implemented mandatory Terms and Conditions agreement checkbox with legal page links
  - Added optional newsletter subscription checkbox for marketing preferences
  - Created /embedded-checkout route with complete Stripe Elements integration
  - Updated subscription page with dual payment options: embedded (default) and hosted checkout
  - Users can now complete payments without leaving website for improved user experience
  - Added error handling for URL parameter parsing and form validation
  - Integrated with existing user authentication and subscription management system
- July 15, 2025. Created embedded Stripe checkout form within the website:
  - Built EmbeddedCheckoutForm component using Stripe Elements for professional payment processing
  - Added comprehensive data collection: personal info, billing address, date of birth validation
  - Included mandatory Terms and Conditions agreement and optional newsletter subscription
  - Created /embedded-checkout route with full Stripe Elements integration
  - Updated subscription page to offer both embedded checkout (default) and hosted Stripe options
  - Users can now complete payments without leaving the website for better user experience
- July 15, 2025. Integrated Stripe free trial within the app interface:
  - Added database fields to track Stripe trial information (stripeTrialEnd, isOnStripeTrial)
  - Enhanced subscription status endpoint to fetch real-time trial data from Stripe API
  - Created TrialStatusBanner component showing trial countdown and upgrade options
  - Webhook handling now updates local trial information when subscriptions are created
  - Users can see exact trial expiration dates and remaining days within the app
- July 15, 2025. Simplified subscription flow with direct Stripe redirect:
  - Replaced embedded checkout form with simple fetch() API call and direct redirect
  - Users now go directly to Stripe's hosted checkout page for better UX
  - Removed complex embedded Stripe Elements form in favor of simpler implementation
  - Payment flow: subscription page → API call → direct redirect to Stripe checkout
- July 15, 2025. Added 7-day free trial to all subscription plans:
  - Implemented trial_period_days: 3 in Stripe checkout sessions
  - Updated domain references to use actual Replit development URL
  - All new subscriptions now include automatic 3-day free trial period
  - Users can experience full features before first payment is charged
- July 15, 2025. Enhanced payment form with professional design and improved data collection:
  - Replaced age field with date of birth for more accurate age verification
  - Added required Terms and Conditions agreement checkbox with links to legal pages
  - Added optional newsletter subscription checkbox for marketing preferences
  - Improved form validation with date-based age calculation (13+ requirement)
  - Enhanced professional design while maintaining user-friendly functionality
  - Button remains disabled until Terms agreement is checked
  - Newsletter preference is passed to backend for future marketing campaigns
- July 15, 2025. Fixed subscription payment flow to create proper recurring billing:
  - Switched embedded checkout from Payment Intents to Stripe Checkout Sessions
  - Fixed subscription creation issue causing payments to appear as one-time instead of recurring
  - Enhanced webhook handling for automatic subscription status updates
  - Added comprehensive database methods for subscription management
  - Subscription status now properly updates from "trial" to "pro"/"unlimited" after payment
  - Payments now appear correctly in Stripe dashboard as recurring subscriptions
- July 15, 2025. Fixed app startup issues and verified Stripe integration:
  - Resolved application startup failures by ensuring all required environment variables are properly configured
  - Confirmed OpenAI API key and Stripe secret key are correctly set and accessible
  - Verified database connection is working properly with PostgreSQL
  - Tested Stripe checkout session creation - working perfectly with successful redirects to checkout.reflectai-journal.site
  - Stripe payment flow is fully functional: users can select plans, create checkout sessions, and be redirected to Stripe
  - Removed debugging logs after confirming Stripe integration is working correctly
- July 15, 2025. Complete Stripe payment integration implementation:
  - Completely removed all LemonSqueezy references and replaced with Stripe
  - Added stripeCustomerId and stripeSubscriptionId fields to users table
  - Implemented Stripe checkout sessions for subscription management
  - Created /api/create-checkout-session endpoint for secure payment processing
  - Updated subscription page with static pricing plans (Pro $14.99/mo, Unlimited $24.99/mo)
  - Built checkout flow using Stripe-hosted pages for PCI compliance
  - Added payment verification system in CheckoutSuccess page
  - App now uses Stripe exclusively for all payment processing with proper webhook handling
- July 13, 2025. Implemented upgrade modal system for premium features:
  - Created UpgradeModal component with professional design for feature upgrade prompts
  - Built UpgradeContext provider to manage upgrade modal state across the application
  - Added automatic detection of subscription-required API errors with custom event handling
  - Integrated upgrade prompts on Stats page ("Advanced Analytics") and MindPatterns page ("Advanced Pattern Analysis")
  - System shows user-friendly popups when accessing Unlimited-only features with option to upgrade
  - Modal includes feature descriptions, required plan badges, and direct links to subscription page
- July 13, 2025. Added comprehensive Terms of Service functionality:
  - Created detailed Terms of Service page at /terms-of-service with legal content covering privacy, billing, AI disclaimers, and usage policies
  - Added comprehensive refund policy section with 7-day money-back guarantee, prorated refunds for annual plans, and clear refund process
  - Added detailed privacy policy covering data collection, usage, protection, sharing, user rights, retention, and international compliance
  - Added Terms of Service link in footer for easy public access
  - Added Terms & Conditions menu item in user profile dropdown for authenticated users
  - Page includes proper styling, responsive design, and professional legal language
  - Fixed app startup issues by resolving ES module import path conflicts between server and frontend
- July 11, 2025. Implemented revised user flow: questionnaire → counselor match → account creation → subscription plans:
  - Created new CounselorMatch page that shows personalized counselor details after questionnaire completion
  - Updated flow: questionnaire → /counselor-match → /auth?tab=register&source=questionnaire → /subscription
  - Users now see their matched counselor profile before being asked to create an account
  - Modified Auth component to detect questionnaire source and redirect appropriately after account creation
  - Simplified checkout flow to use direct LemonSqueezy URLs for reliable payment processing
  - Enhanced user engagement by showing counselor match results before requesting account creation
- July 11, 2025. Fixed payment confirmation button text and LemonSqueezy checkout integration:
  - Updated both PaymentSuccess and CheckoutSuccess page buttons to say "Go to App" instead of "View Order"
  - Resolved LemonSqueezy API "Unprocessable Entity" errors by switching to direct checkout URLs with custom success parameters
  - Direct URLs include checkout[custom][success_url] parameter to redirect to /checkout-success after payment
  - Eliminated complex API integration that was causing validation errors
  - All payment confirmations now have clear "Go to App" buttons that redirect to the application
- July 11, 2025. Fixed iPhone button overflow on counselor match page:
  - Made counselor journey button responsive with shorter text on mobile devices
  - Added progressive text shortening: desktop shows full text, mobile shows "Begin with [Name]"
  - Improved overall mobile layout with better padding and spacing for iPhone screens
  - Button now fits properly within screen bounds on all device sizes
- July 11, 2025. Created comprehensive user tutorial system for new subscribers:
  - Built interactive tutorial component with step-by-step guidance through all features
  - Added tutorial trigger on successful subscription payments (both Stripe and LemonSqueezy)
  - Created tutorial context provider for managing tutorial state across the app
  - Added manual tutorial trigger in Settings page under Help & Support section
  - Tutorial covers counselor chat, journaling, philosophy mode, goals, check-ins, and analytics
  - Users can skip or complete tutorial, with progress saved in localStorage
  - Tutorial automatically starts for new premium subscribers after payment
- July 11, 2025. Updated logo to transparent SVG for better display across backgrounds:
  - Created new transparent SVG logo with blue-to-purple gradient
  - Updated all logo imports across App.tsx, Header.tsx, Landing.tsx, Auth.tsx, and Footer.tsx
  - Removed dark background from logo for better integration with light and dark themes
  - Logo now displays consistently on all pages with transparent background
- July 11, 2025. Enhanced daily check-in system with intelligent issue tracking:
  - Added new database fields to check-ins: isResolved, priority, tags, followUpDate for comprehensive issue tracking
  - Implemented automated daily check-in generation with personalized wellness questions
  - Created intelligent AI analysis system that determines if issues are resolved based on user responses
  - Added automatic follow-up scheduling for unresolved high-priority issues (1 day for urgent, 3 days for high priority)
  - Enhanced MemoryLane page with prominent daily check-in interface and improved check-in type badges
  - Added new API endpoints: /api/check-ins/daily, /api/check-ins/daily/status, /api/check-ins/unresolved
  - System now provides continuous support by automatically following up on concerning responses
- July 11, 2025. Major logo update with new gradient ReflectAI brand identity:
  - Replaced all logo instances across Header, Landing, Auth, Footer, and App loading screen with new gradient logo
  - Updated favicon and app icons with new branding
  - Removed all CSS color filters to display logo in original blue gradient colors
  - Updated logo file path to 'new-reflectai-logo.png' across all components
  - Logo now displays consistent dark blue to purple gradient design on all pages
- July 11, 2025. Complete branding update with new ReflectAI logo:
  - Replaced all logo instances across Header, Landing, Auth, and mobile app pages with official Reflect AI Logo.png
  - Removed CSS color filters to display logo in original colors
  - Updated favicon and app icons with new branding
  - Streamlined logo styling by removing redundant text labels
  - Maintained consistent logo sizing across all components
- July 11, 2025. Updated payment flow to redirect to AI counselor page:
  - Modified PaymentSuccess component to automatically redirect to '/app/counselor' after 2 seconds
  - Updated payment success button text to "Start Counseling Session"
  - Added LemonSqueezy webhook endpoint at '/api/webhooks/lemonsqueezy' to handle payment confirmations
  - Created new CheckoutSuccess page for LemonSqueezy redirect flow
  - Updated LemonSqueezy checkout configuration to include success_url pointing to '/checkout-success'
  - Added payment success redirect endpoint at '/api/payment-success' for authenticated users
  - All successful payments now direct users to the AI counseling interface immediately
- July 11, 2025. Removed Plausible analytics tracking:
  - Deleted all Plausible script tags from HTML files
  - Removed plausible-init.js file
  - Updated Content Security Policy to remove Plausible domains
  - Cleaned up iOS app HTML files
  - Application no longer sends any data to Plausible analytics
- July 11, 2025. Removed Check-ins and Challenges features:
  - Completely deleted Check-ins and Challenges pages and components
  - Removed navigation items for both features from bottom navigation
  - Added redirects for old /app/check-ins and /app/challenges routes to home page
  - Simplified secondary navigation to only include Stats and Archives
  - App now focuses on core journaling and AI conversation features
- July 11, 2025. Replaced Memory Lane with Check-ins system:
  - Implemented complete check-ins database schema with scheduled follow-ups
  - Added automatic check-in creation when AI asks questions during conversations
  - Created check-ins API endpoints and storage interface
  - Replaced Memory Lane page content with Check-ins functionality
  - Check-ins are scheduled 2-3 days after AI questions for continued dialogue
  - Users can respond to check-ins and receive AI follow-up responses
- July 11, 2025. Enhanced AI responsiveness and user profile styling:
  - Reduced AI response length to 2-3 sentences max with 150 token limit
  - Updated all AI personalities to always end with engaging questions
  - Made AI responses more interactive and conversation-focused
  - Added colorful modern user profile section to Settings page
  - Profile includes gradient avatar, subscription badges, and stats cards
  - Implemented glassmorphism design with backdrop blur effects
- July 11, 2025. Updated subscription plan pricing:
  - Changed Pro monthly price from $9.99 to $14.99
  - Changed Pro annual price from $101.90 to $152.90 (15% discount maintained)
  - Changed Unlimited monthly price from $17.99 to $24.99
  - Changed Unlimited annual price from $183.50 to $254.90 (15% discount maintained)
  - Updated pricing in both main server routes and iOS configuration
- July 8, 2025. Major pivot: Transformed app focus from journaling to AI counselor:
  - Changed main messaging from "AI-powered journaling" to "AI counselor made just for you"  
  - Updated hero section: "Talk Anywhere Anytime with your AI counselor made just for you"
  - Revised all features to focus on counseling: 24/7 support, personalized guidance, crisis support
  - Changed about section to "Your Personal AI Counselor" with therapy-focused benefits
  - Updated visual mockups from mood charts to chat interface representation
  - Modified call-to-action from "Try AI Reflection" to "Talk to AI Counselor"
- July 8, 2025. Updated subscription naming and improved chat interfaces:
  - Changed subscription plan naming from "yearly" to "annually" for better clarity
  - Added smooth animations for chat focus modes with slide-in/slide-out transitions
  - Implemented Cancel and Send buttons for both Counselor and Philosopher fullscreen modes
  - Fixed cursor positioning and visibility in all text input areas
  - Added billing period toggle on subscription page for easy switching between monthly/annual plans
  - Reduced zoom levels further (85% desktop, 75% mobile) for more compact interface
- July 7, 2025. Fixed AI insights, text input sizing, and navigation layout issues:
  - Fixed AI insights by adding proper user authentication to all journal entry routes
  - Added user ID verification to ensure users can only access their own entries
  - Improved textarea auto-resize with proper viewport sizing and scroll handling
  - Fixed navigation layout by moving entries counter below premium button
  - Enhanced textarea styling with better focus states and responsive design
  - Tested and verified all fixes work correctly with real user sessions
- July 4, 2025. Fixed deployment issues:
  - Converted server from CommonJS to ES modules
  - Updated TypeScript configuration for ES2022 target
  - Fixed module imports in server/index.ts and server/security.ts
  - Ensured consistent port 5000 usage for deployment
  - Verified production build process works correctly
- June 27, 2025. Initial setup

## User Preferences

Preferred communication style: Simple, everyday language.